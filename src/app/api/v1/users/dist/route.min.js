"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.GET=GET,exports.POST=POST;var _users=require("@/lib/packages/users/users.service"),_server=require("next/server");function GET(){var r;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap((0,_users.getAllUsers)());case 2:if(r=e.sent){e.next=5;break}return e.abrupt("return",_server.NextResponse.json({message:"No user exists on the app, retry later",users:[]},{status:400}));case 5:return e.abrupt("return",_server.NextResponse.json({users:r}));case 6:case"end":return e.stop()}})}function POST(r){var s,t,n,a,u,o,i,p,c,l,x;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(r.json());case 2:if(s=e.sent){e.next=5;break}return e.abrupt("return",_server.NextResponse.json({message:"A body is expected on the request but none has been found"},{status:400}));case 5:if(t=s.firstName,n=s.lastName,a=s.email,u=s.phone,o=s.password,i=s.role,p=void 0===i?"STUDENT":i,c=[],t||c.push("firstName"),n||c.push("lastName"),a||c.push("email"),u||c.push("phone"),o||c.push("password"),0<c.length)return e.abrupt("return",_server.NextResponse.json({message:"Some fields are mandatory but they are missing",missingFields:c},{status:400}));e.next=14;break;case 14:return e.next=16,regeneratorRuntime.awrap((0,_users.isUserExistByEmail)(a));case 16:if(e.sent)return e.abrupt("return",_server.NextResponse.json({message:"An account with the provided email already exists",signInPath:"/api/v1/sign-in"},{status:400}));e.next=19;break;case 19:return console.log({body:s}),l={firstName:t,lastName:n,email:a,phone:u,role:p,password:o},e.next=23,regeneratorRuntime.awrap((0,_users.createUser)(l));case 23:if(x=e.sent,console.log({newUser:x}),x){e.next=27;break}return e.abrupt("return",_server.NextResponse.json({message:"An unexpected error has occured, plese try creating the user later"},{status:500}));case 27:return e.abrupt("return",_server.NextResponse.json({user:x,url:"/api/v1/users/".concat(x.id)},{status:201}));case 28:case"end":return e.stop()}})}
//# sourceMappingURL=route.min.js.map
